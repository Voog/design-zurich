var MMCQ,PriorityQueue;PriorityQueue=function(){function e(e){this.comparator=e,this.contents=[],this.sorted=!1}return e.prototype.sort=function(){return this.contents.sort(this.comparator),this.sotred=!0},e.prototype.push=function(e){return this.contents.push(e),this.sorted=!1},e.prototype.peek=function(e){return null==e&&(e=this.contents.length-1),this.sorted||this.sort(),this.contents[e]},e.prototype.pop=function(){return this.sorted||this.sort(),this.contents.pop()},e.prototype.size=function(){return this.contents.length},e.prototype.map=function(e){return this.contents.map(e)},e}(),MMCQ=function(){function e(){this.maxIterations=1e3,this.fractByPopulations=.75}var t,o,n,s,a,r;return e.sigbits=5,e.rshift=8-e.sigbits,s=function(t,o,n){return(t<<2*e.sigbits)+(o<<e.sigbits)+n},t=function(){function t(e,t,o,n,s,a,r){this.r1=e,this.r2=t,this.g1=o,this.g2=n,this.b1=s,this.b2=a,this.histo=r}return t.prototype.volume=function(e){return this._volume&&!e||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},t.prototype.count=function(e){var t,o,n,a,r,i,l,c,g,u,d;if(!this._count_set||e){for(a=0,r=i=this.r1,g=this.r2;i<=g;r=i+=1)for(o=l=this.g1,u=this.g2;l<=u;o=l+=1)for(t=c=this.b1,d=this.b2;c<=d;t=c+=1)n=s(r,o,t),a+=this.histo[n]||0;this._count_set=!0,this._count=a}return this._count},t.prototype.copy=function(){return new t(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},t.prototype.average=function(t){var o,n,a,r,i,l,c,g,u,d,h,p,f,b,m,v;if(!this._average||t){for(c=1<<8-e.sigbits,d=0,u=0,r=0,n=0,g=h=this.r1,b=this.r2;h<=b;g=h+=1)for(a=p=this.g1,m=this.g2;p<=m;a=p+=1)for(o=f=this.b1,v=this.b2;f<=v;o=f+=1)l=s(g,a,o),d+=i=this.histo[l]||0,u+=i*(g+.5)*c,r+=i*(a+.5)*c,n+=i*(o+.5)*c;this._average=d?[~~(u/d),~~(r/d),~~(n/d)]:[~~(c*(this.r1+this.r2+1)/2),~~(c*(this.g1+this.g2+1)/2),~~(c*(this.b1+this.b2+1)/2)]}return this._average},t.prototype.contains=function(t){var o,n,s;return s=t[0]>>e.rshift,n=t[1]>>e.rshift,o=t[2]>>e.rshift,this.r1<=s&&s<=this.r2&&this.g1<=n&&n<=this.g2&&this.b1<=o&&o<=this.b2},t}(),o=function(){function e(){this.cboxes=new PriorityQueue(function(e,t){var o,n;return o=e.count()*e.volume(),n=t.count()*t.volume(),o>n?1:o<n?-1:0})}return e.prototype.push=function(e){return this.cboxes.push({cbox:e,color:e.average()})},e.prototype.palette=function(){return this.cboxes.map(function(e){return e.color})},e.prototype.size=function(){return this.cboxes.size()},e.prototype.map=function(e){var t,o,n;for(t=o=0,n=this.cboxes.size();o<n;t=o+=1)return this.cboxes.peek(t).cbox.contains(e)?this.cboxes.peek(t).color:this.nearest(e)},e.prototype.cboxes=function(){return this.cboxes},e.prototype.nearest=function(e){var t,o,n,s,a,r,i;for(a=function(e){return e*e},n=1e9,o=r=0,i=this.cboxes.size();r<i;o=r+=1)(t=Math.sqrt(a(e[0]-this.cboxes.peek(o).color[0])+a(e[1]-this.cboxes.peek(o).color[1])+a(e[2]-this.cboxes.peek(o).color[2])))<n&&(n=t,s=this.cboxes.peek(o).color);return s},e}(),a=function(t){var o,n,a,r,i,l,c,g,u;for(r=1<<3*e.sigbits,a=new Array(r),g=0,u=t.length;g<u;g++)c=(l=t[g])[0]>>e.rshift,n=l[1]>>e.rshift,o=l[2]>>e.rshift,a[i=s(c,n,o)]=(a[i]||0)+1;return a},n=function(o,n){var s,a,r,i,l,c,g,u,d,h,p,f;for(h=1e6,d=0,c=1e6,l=0,r=1e6,a=0,p=0,f=o.length;p<f;p++)u=(g=o[p])[0]>>e.rshift,i=g[1]>>e.rshift,s=g[2]>>e.rshift,u<h?h=u:u>d&&(d=u),i<c?c=i:i>l&&(l=i),s<r?r=s:s>a&&(a=s);return new t(h,d,c,l,r,a,n)},r=function(e,t){var o,n,a,r,i,l,c,g,u,d,h,p,f,b,m,v,C,k,y,j,w,x,_,P,M,I,z,D,S,Q;if(t.count()){if(1===t.count())return[t.copy()];if(d=t.r2-t.r1+1,i=t.g2-t.g1+1,n=t.b2-t.b1+1,c=Math.max(d,i,n),p=0,g=[],l=[],c===d)for(u=f=t.r1,x=t.r2;f<=x;u=f+=1){for(h=0,r=b=t.g1,z=t.g2;b<=z;r=b+=1)for(o=m=t.b1,D=t.b2;m<=D;o=m+=1)h+=e[s(u,r,o)]||0;p+=h,g[u]=p}else if(c===i)for(r=v=t.g1,S=t.g2;v<=S;r=v+=1){for(h=0,u=C=t.r1,Q=t.r2;C<=Q;u=C+=1)for(o=k=t.b1,_=t.b2;k<=_;o=k+=1)h+=e[s(u,r,o)]||0;p+=h,g[r]=p}else for(o=y=t.b1,P=t.b2;y<=P;o=y+=1){for(h=0,u=j=t.r1,M=t.r2;j<=M;u=j+=1)for(r=w=t.g1,I=t.g2;w<=I;r=w+=1)h+=e[s(u,r,o)]||0;p+=h,g[o]=p}return g.forEach(function(e,t){return l[t]=p-e}),a=function(e){var o,n,s,a,r,i,c,u,d,h,f;for(i=e+"2",c=h=t[r=e+"1"],f=t[i];h<=f;c=h+=1)if(g[c]>p/2){for(o=t.copy(),n=t.copy(),a=(u=c-t[r])<=(d=t[i]-c)?Math.min(t[i]-1,~~(c+d/2)):Math.max(t[r],~~(c-1-u/2));!g[a];)a++;for(s=l[a];!s&&g[a-1];)s=l[--a];return o[i]=a,n[r]=o[i]+1,[o,n]}},c===d?a("r"):c===i?a("g"):c===n?a("b"):void 0}},e.prototype.quantize=function(e,t){var s,i,l,c,g,u,d=this;if(!e.length||t<2||t>256)return console.log("invalid arguments"),!1;for(l=a(e),s=n(e,l),(g=new PriorityQueue(function(e,t){var o,n;return o=e.count(),n=t.count(),o>n?1:o<n?-1:0})).push(s),(c=function(e,t){var o,n,a,i,c;for(i=1,c=0;c<d.maxIterations;)if((s=e.pop()).count()){if(a=r(l,s),o=a[0],n=a[1],!o)return void console.log("cbox1 not defined; shouldn't happen");if(e.push(o),n&&(e.push(n),i++),i>=t)return;if(c++>d.maxIterations)return void console.log("infinite loop; perhaps too few pixels")}else e.push(s),c++})(g,this.fractByPopulations*t),u=new PriorityQueue(function(e,t){var o,n;return o=e.count()*e.volume(),n=t.count()*t.volume(),o>n?1:o<n?-1:0});g.size();)u.push(g.pop());for(c(u,t-u.size()),i=new o;u.size();)i.push(u.pop());return i},e}.call(this),function(){window.ColorExtract=function(){function e(){}return e.getColorMap=function(e,t,o,n,s,a){var r,i,l,c,g,u,d,h,p,f;for(null==a&&(a=8),l=e.getContext("2d").getImageData(t,o,n,s).data,c=[],u=d=o,p=o+s;d<p;u=d+=1)for(i=u*n*4,g=h=t,f=t+n;h<f;g=h+=1)r=i+4*g,c.push([l[r],l[r+1],l[r+2]]);return(new MMCQ).quantize(c,a)},e.colorDist=function(e,t){var o;return(o=function(e){return e*e})(e[0]-t[0])+o(e[1]-t[1])+o(e[2]-t[2])},e.extract=function(t,o,n){var s,a,r,i,l,c,g,u,d,h,p,f,b;for(o.width=25,o.height=25,o.getContext("2d").drawImage(t,0,0,o.width,o.height),(a=e.getColorMap(o,0,0,o.width,o.height,4).cboxes.map(function(e){return{count:e.cbox.count(),rgb:e.color}})).sort(function(e,t){return t.count-e.count}),s=a[0].rgb,(g=e.getColorMap(o,0,0,t.width,t.height,10).cboxes.map(function(e){return{count:e.cbox.count(),rgb:e.color}})).sort(function(e,t){return t.count-e.count}),u=0,h=0,f=g.length;h<f;h++)r=g[h],(i=e.colorDist(s,r.rgb))>u&&(u=i,l=r.rgb);for(u=0,p=0,b=g.length;p<b;p++)r=g[p],(i=e.colorDist(s,r.rgb))>u&&r.rgb!==l&&(u=i,c=r.rgb);return d=function(e){return"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},n({bgColor:d(s),fgColor:d(l),fgColor2:d(c)})},e}()}.call(this),function(e){var t=e("html").hasClass("editmode"),o=function(){e("html");var t=e(".js-menu-language-settings");e(window).width()<=960&&0===t.closest(".js-menu-lang-mobile").length?t.appendTo(".js-menu-lang-mobile"):e(window).width()>960&&0===t.closest(".js-menu-lang-desktop").length&&t.appendTo(".js-menu-lang-desktop")},n=function(t,o){var n='[data-bg-global="'+t.attr("data-bg-global")+'"]',s=(t.attr("data-bg-global-boolean"),'[data-bg-global-boolean="false"]'),a='[data-section-name="'+t.attr("data-section-name")+'"]';if(bgPickerCombinedLightness>=.5?(e(t).find(".js-background-type").addClass("light-background").removeClass("dark-background"),e(a).find(".js-background-type").addClass("light-background").removeClass("dark-background"),e(t).is('[data-bg-global-master="true"]')&&e(n).not(s).find(".js-background-type").addClass("light-background").removeClass("dark-background")):(e(t).find(".js-background-type").addClass("dark-background").removeClass("light-background"),e(a).find(".js-background-type").addClass("dark-background").removeClass("light-background"),e(t).is('[data-bg-global-master="true"]')&&e(n).not(s).find(".js-background-type").addClass("dark-background").removeClass("light-background")),e("body").find('[data-bg-global-master="true"]').find(".js-background-type").hasClass("light-background"))var r="light-background";else r="dark-background";e(".container").find(".js-bg-picker-area").removeClass("transparent-dark-background transparent-light-background").addClass("transparent-"+r),e(".container").find(n).removeClass("transparent-dark-background transparent-light-background").addClass("transparent-"+r),o>=.5?(e(t).attr("data-bg-global-boolean",!1),e(a).attr("data-bg-global-boolean",!1)):(e(t).attr("data-bg-global-boolean",!0),e(a).attr("data-bg-global-boolean",!0),e(t).find(".js-background-type").removeClass("light-background dark-background").addClass(r),e(a).find(".js-background-type").removeClass("light-background dark-background").addClass(r))},s=function(t,o){return function(t,o){if(t&&o){"string"==typeof t&&(t=t.replace(/rgba?\(/,"").replace(/\)/,"").split(","),e.each(t,function(e,o){t[e]=+o})),"string"==typeof o&&(o=o.replace(/rgba?\(/,"").replace(/\)/,"").split(","),e.each(o,function(e,t){o[e]=+t})),"object"==typeof t&&t.hasOwnProperty("length")&&3==t.length&&t.push(1),"object"==typeof o&&o.hasOwnProperty("length")&&3==o.length&&o.push(1);var n=[0,0,0,0];return n[3]=1-(1-o[3])*(1-t[3]),0===n[3]&&(n[3]=1e-6),n[0]=Math.min(o[0]*o[3]/n[3]+t[0]*t[3]*(1-o[3])/n[3],255),n[1]=Math.min(o[1]*o[3]/n[3]+t[1]*t[3]*(1-o[3])/n[3],255),n[2]=Math.min(o[2]*o[3]/n[3]+t[2]*t[3]*(1-o[3])/n[3],255),e.map(n,function(e){return Math.floor(e)})}}(t||[255,255,255,1],o||[255,255,255,1])},a=function(e,t){var o=s(e,t);return Math.round((.2126*+o[0]+.7152*+o[1]+.0722*+o[2])/2.55)/100},r=function(){e(window).resize(function(e,t,o){var n;return function(){var s=this,a=arguments,r=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||e.apply(s,a)},t),r&&e.apply(s,a)}}(function(){o()},100))};window.site=e.extend(window.site||{},{initBlogPage:function(){},initArticlePage:function(){},initCommonPage:function(){handleFormFieldClick()},bindLanguageMenuSettings:function(t){"type"in t||(t.type="popover"),"item_state"in t||(t.item_state="flags_and_names");new Edicy.SettingsEditor(e(".js-menu-language-settings-toggle").get(0),{menuItems:[{titleI18n:"format_desktop_only",type:"radio",key:"type",list:[{titleI18n:"dropdown_menu",value:"popover"},{titleI18n:"expanded_menu",value:"list"}]},{titleI18n:"show",type:"radio",key:"item_state",list:[{titleI18n:"flags_only",value:"flags_only"},{titleI18n:"names_only",value:"names_only"},{titleI18n:"flags_and_names",value:"flags_and_names"}]}],values:t,buttonTitleI18n:"settings",containerClass:["js-menu-language-settings-popover","js-prevent-sideclick"],preview:function(t){var n=e("html");e(".js-menu-language-settings"),"list"===t.type?(n.removeClass("language-menu-mode-popover"),n.removeClass("menu-language-popover-open"),n.addClass("language-menu-mode-list")):(n.removeClass("language-menu-mode-list"),n.addClass("language-menu-mode-popover"),n.addClass("menu-language-popover-open"),e(".js-menu-lang-popover").addClass("expanded")),"flags_only"===t.item_state?(n.removeClass("language-flags-disabled"),n.removeClass("language-names-enabled"),n.addClass("language-flags-enabled"),n.addClass("language-names-disabled")):"names_only"===t.item_state?(n.removeClass("language-flags-enabled"),n.removeClass("language-names-disabled"),n.addClass("language-flags-disabled"),n.addClass("language-names-enabled")):"flags_and_names"===t.item_state&&(n.removeClass("language-flags-disabled"),n.removeClass("language-names-disabled"),n.addClass("language-flags-enabled"),n.addClass("language-names-enabled")),o(),this.setPosition()},commit:function(e){siteData.set("settings_language_menu",e)}});o()},togglePadding:function(){e(".voog-padding-switcher").on("click",function(t){t.stopPropagation();var o=e(this).closest(".feature-section"),n=o.attr("data-section-name");if(e(o).toggleClass("section-with-padding"),e(this).closest(o).hasClass("section-with-padding"))var s=!1;else s=!0;pageData.set(n+"_is_wide",s)})},bgPickerPreview:function(t,o,s,r){var i=e(t).find(".js-background-image").css("background-image"),l=o.imageSizes?function(e,t){for(var o,n=0,s=e.length;n<s;n++){if(e[n].width<t)return o||e[n];o=e[n]}return e[e.length-1]}(o.imageSizes,e(window).width()):null,c=o.image&&""!==o.image?"url("+l.url+")":"none",g=o.imageSizes&&""!==o.imageSizes?o.imageSizes:null,u=o.color&&""!==o.color?o.color:"rgba(0,0,0,0)",d=o.colorData&&""!==o.colorData?o.colorData.a:0,h=r,p=e("<img>"),f=e("<canvas>"),b=o.image&&""!==o.image?o.image:null;b?function(e,t){for(var o=e.length;o--;)if(t.indexOf(e[o].url.trim())>-1)return!0;return!1}(g,i)?(bgPickerCombinedLightness=a(h,u),n(t,d),bgPickerImageColorData=h):(p.attr("src",b.replace(/.*\/(photos|voogstock)/g,"/photos")),p.on("load",function(){ColorExtract.extract(p[0],f[0],function(e){s.bgPickerImageColor=e.bgColor?e.bgColor:"rgba(255,255,255,1)",bgPickerCombinedLightness=a(s.bgPickerImageColor,u),n(t,d),bgPickerImageColorData=e.bgColor?e.bgColor:"rgba(255,255,255,1)",h=s.bgPickerImageColor})})):(bgPickerCombinedLightness=a("rgba(255,255,255,1)",u),n(t,d),bgPickerImageColorData=""),e(t).find(".js-background-image").css({"background-image":c}),e(t).find(".js-background-color").css({"background-color":u})},bgPickerCommit:function(t,o){var n=e.extend(!0,{},o);n.image=o.image||"",n.imageSizes=o.imageSizes||"",n.color=o.color||"",n.combinedLightness=bgPickerCombinedLightness,n.imageColorData=bgPickerImageColorData||"","articlePage"===pageType?"footer_bg"==t?siteData.set(t,n):Edicy.articles.currentArticle.setData(t,n):"contentPage"===pageType&&"footer_bg"===t||"body_bg"===t?siteData.set(t,n):pageData.set(t,n)},bgPickerColorScheme:function(t){void 0!==t&&(t>.6?e(".header-wrapper").addClass("light").removeClass("dark"):e(".header-wrapper").addClass("dark").removeClass("light"))},bindSiteSearch:function(t,o,n){t&&new VoogSearch(t,{per_page:10,lang:o,resultsContainer:e(".js-voog-search-modal-inner").get(0),sideclick:!0,mobileModeWidth:480,updateOnKeypress:!0,noResults:n})},bindSiteSearchFrontPage:function(t,o,n){t&&new VoogSearch(t,{per_page:10,lang:o,resultsContainer:e(".js-voog-search-inline-modal-inner").get(0),sideclick:!0,mobileModeWidth:480,updateOnKeypress:!0,noResults:n})}}),e(".content, .sections, .footer").on("mousedown",function(t){e(t.target).closest(".js-prevent-sideclick").length||(e(".js-popover").removeClass("expanded"),e("body").hasClass("search-open")&&e(".js-search-close-btn").trigger("click"))}),e(".js-menu-btn").click(function(t){t.stopPropagation(),e(this).toggleClass("open"),e(".js-menu-main").toggleClass("expanded"),e(".js-search-close-btn").hasClass("open")&&e(".js-search-close-btn").trigger("click")}),e(".js-menu-lang-btn").click(function(t){t.stopPropagation(),e(".js-menu-lang-popover").toggleClass("expanded")}),e(".js-search-open-btn").click(function(t){t.stopPropagation(),e(".js-menu-main").hasClass("expanded")&&(e(".js-menu-main").removeClass("expanded"),e(".js-menu-btn").removeClass("open")),e(this).addClass("open"),e("body").addClass("search-open"),e(".js-search-close-btn").addClass("open"),e(".js-search").addClass("active"),e(".js-search-inner").css({"margin-top":"-25px"}),e(".js-search-input").val("").focus()}),e(".js-search-close-btn").click(function(t){e(this).removeClass("open"),e("body").removeClass("search-open"),e(".js-search-open-btn").removeClass("open"),e(".js-search").removeClass("active")}),e(".js-search").click(function(e){e.stopPropagation()}),e(document).ready(function(){e(".comment-form").hasClass("form_with_errors")?e("html, body").scrollTop(e(".comment-form").offset().top):e("form").find(".form_error, .form_notice").length>0&&e("html, body").scrollTop(e(".form_error, .form_notice").closest("form").offset().top)}),r(),searchForm=e(".js-search-form"),e(".js-search-input").focus(function(){searchForm.addClass("active")}).blur(function(){searchForm.removeClass("active")}),e(".js-search-form").on("submit",function(){searchModalHeight=e(".js-voog-search-modal").height(),e(".js-modal").css({top:"40px"})}),!1===t&&e.each(e(".content-formatted"),function(){e(this).hasClass("js-custom-content-formatted")||e(this).find("table").wrap('<div class="table-container"></div>')}),e(".voog-bg-picker-btn").on("click",function(t){e(this).closest(".container").find(".voog-bg-picker-btn.open").not(this).trigger("click").removeClass("open"),e(this).toggleClass("open"),t.stopPropagation()}),e(".container").on("mousedown",function(t){e(t.target).closest(".voog-bg-picker-btn").length||(e(this).find(".voog-bg-picker-btn").removeClass("open"),t.stopPropagation())}),!Modernizr.flexbox&&t&&function(){var t=e(".js-header").width(),o=e(".js-header-right"),n=o.width(),s=parseInt(o.css("margin-left"))+1;e(".js-header-left").css("min-width",t-n-s)}(),Modernizr.flexbox||Modernizr.flexwrap||e("html").addClass("no-flexbox"),e("html").hasClass("no-flexbox")&&(function(){var t=e(".sections").height();e(".feature-section").outerHeight(t)}(),e("body").hasClass("front-page")&&function(){var t=e(window).height()+e("header").height()-e("footer").height();e("main.content").height(t)}())}(jQuery);